# I had to modify port 8443 in the quickstart script to something else because of the following error:
# docker: Error response from daemon: failed to set up container networking: driver failed programming external connectivity on endpoint kong-quickstart-gateway (505d8d38434db360d0c91a650153093856de816e94f7ddd3cf1df430afcea95d): Bind for 0.0.0.0:8443 failed: port is already allocated

export KONNECT_TOKEN=<your token from KONNECT admin portal>
source deck_container_alias_command.sh
deck gateway ping
deck gateway apply llm_service.yaml
deck gateway apply openai-chat.yaml
deck gateway apply aiproxy_plugin.yaml

curl -X POST "$KONNECT_PROXY_URL/chat" \
     -H "Accept: application/json"\
     -H "Content-Type: application/json"\
     -H "Authorization: Bearer $OPENAI_KEY" \
     --data '{
       "model": "gpt-4",
       "messages": [
         {
           "role": "user",
           "content": "Say this is a test!"
         }
       ]h 
     }'

for i in {1..10}; do source curl_test_aigw.sh; done 

to send a POST in Chrome dev tools do this:

const OPENAI_KEY=<'your openai key here'>;

fetch('http://52.206.9.54:8000/chat', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json', // Or 'application/x-www-form-urlencoded' depending on your API
        'Authorization': 'Bearer YOUR_AUTH_TOKEN' // If authentication is required
    },
    body: JSON.stringify({ // Stringify the body for JSON content-type
       "model": "gpt-4",
       "messages": [
         {
           "role": "user",
           "content": "Say this is a test!"
         }
       ]
    })
})
.then(response => {
    if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
    }
    return response.json(); // Or response.text() if the response is not JSON
})
.then(data => {
    console.log('Success:', data);
})
.catch(error => {
    console.error('Error:', error);
});




